2021-08-11 16:16:45.062 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 2568 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:16:45.085 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:16:45.085 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:16:48.935 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 4.668 seconds (JVM running for 9.216)
2021-08-11 16:18:04.078 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 4476 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:18:04.089 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:18:04.089 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:18:06.990 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 3.764 seconds (JVM running for 7.742)
2021-08-11 16:18:21.776 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: f4e5276b-7eb5-4dd5-8df3-8c8774ee9146
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 92b0b5f9-689e-49cf-9c16-b36e66e30a6b
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:18:21.937 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: f4e5276b-7eb5-4dd5-8df3-8c8774ee9146
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:18:22.053 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:18:22.053 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:18:22.053 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:18:22.053 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:18:23.368 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: null
2021-08-11 16:18:23.369 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:18:23.369 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:18:23.369 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:18:23.370 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:18:23.370 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:18:23.370 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:18:24.083 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:18:24.085 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:18:27.232 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: {"code":"200","message":"Success","data":{"id":1,"createdAt":1628673505315,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}
2021-08-11 16:18:27.232 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:18:27.233 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:18:27.250 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: f4e5276b-7eb5-4dd5-8df3-8c8774ee9146
[BODY RESPONSE]: 

{"code":"200","message":"Success","responseId":"f4e5276b-7eb5-4dd5-8df3-8c8774ee9146","data":{"id":1,"createdAt":1628673505315,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:18:41.044 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: a984965d-a400-4229-9a00-cf0b68ff3569
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 155a124a-f9f6-47a1-8f0e-6a2f13f6cbae
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:18:41.047 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: a984965d-a400-4229-9a00-cf0b68ff3569
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:18:41.048 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:18:41.048 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:18:41.049 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:18:41.049 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:18:41.065 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:18:25 PM"}
2021-08-11 16:18:41.069 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:116) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:18:41.084 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: a984965d-a400-4229-9a00-cf0b68ff3569
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"a984965d-a400-4229-9a00-cf0b68ff3569"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:18:56.303 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 753623b2-e7b7-4fe9-8dd0-0d4643b48928
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 15d8d26e-995a-4de8-b644-563eef7f1856
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:18:56.307 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 753623b2-e7b7-4fe9-8dd0-0d4643b48928
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:18:56.308 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:18:56.309 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:18:56.310 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:18:56.310 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:18:56.318 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:18:25 PM"}
2021-08-11 16:18:56.319 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:18:56.319 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:18:56.319 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:18:56.319 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:18:56.320 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:18:56.320 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:18:56.364 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:18:56.364 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:18:56.514 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: {"code":"200","message":"Success","data":{"id":2,"createdAt":1628673536447,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}
2021-08-11 16:18:56.514 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:18:56.515 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:18:56.516 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 753623b2-e7b7-4fe9-8dd0-0d4643b48928
[BODY RESPONSE]: 

{"code":"200","message":"Success","responseId":"753623b2-e7b7-4fe9-8dd0-0d4643b48928","data":{"id":2,"createdAt":1628673536447,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:22:35.470 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: fbe25a6f-f39f-4841-ad70-d8e71ce29658
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 1d35f0fa-e65c-415d-89bd-8d80b368a271
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:22:35.475 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: fbe25a6f-f39f-4841-ad70-d8e71ce29658
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:22:35.477 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:22:35.477 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:22:35.478 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:22:35.478 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:22:35.485 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:18:56 PM"}
2021-08-11 16:22:35.485 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:116) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:22:35.490 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: fbe25a6f-f39f-4841-ad70-d8e71ce29658
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"fbe25a6f-f39f-4841-ad70-d8e71ce29658"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:22:41.448 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: ab844c34-9ddf-4fab-9cb1-406dd8756c00
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 3a51f25c-d62a-4f48-b527-b5d34fadea93
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:22:41.450 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: ab844c34-9ddf-4fab-9cb1-406dd8756c00
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:22:41.451 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:22:41.451 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:22:41.451 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:22:41.451 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:22:41.458 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:18:56 PM"}
2021-08-11 16:22:41.459 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:22:41.459 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:22:41.460 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:22:41.460 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:22:41.460 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:22:41.460 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:22:41.498 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:22:41.499 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:22:46.526 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:22:46.527 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:22:46.527 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:22:46.528 handleAllOtherException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Exception: null
java.lang.NullPointerException: null
	at vn.vnpay.preprocess.util.ResponsePreProcessor.buildResponseEntity(ResponsePreProcessor.java:15) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:33) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:22:46.535 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: ab844c34-9ddf-4fab-9cb1-406dd8756c00
[BODY RESPONSE]: 

{"code":"500","responseId":"ab844c34-9ddf-4fab-9cb1-406dd8756c00"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:23:08.028 logRequest --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 9724ef5c-d85e-409e-86a7-5bcbb960a598
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 69d2b24c-ae80-46f6-a383-c7b33d7056a7
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:23:08.030 logRequest --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 9724ef5c-d85e-409e-86a7-5bcbb960a598
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:23:08.032 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:23:08.032 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:23:08.032 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:23:08.033 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:23:08.042 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:18:56 PM"}
2021-08-11 16:23:08.043 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:23:08.043 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:23:08.043 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:23:08.043 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:23:08.043 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:23:08.044 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:23:08.092 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:23:08.093 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:23:13.101 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:23:13.104 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:23:13.104 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:23:13.105 handleAllOtherException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Exception: null
java.lang.NullPointerException: null
	at vn.vnpay.preprocess.util.ResponsePreProcessor.buildResponseEntity(ResponsePreProcessor.java:15) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:33) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:23:13.108 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 9724ef5c-d85e-409e-86a7-5bcbb960a598
[BODY RESPONSE]: 

{"code":"500","responseId":"9724ef5c-d85e-409e-86a7-5bcbb960a598"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:26:10.309 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 15128 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:26:10.360 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:26:10.361 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:26:14.850 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 6.207 seconds (JVM running for 9.664)
2021-08-11 16:27:18.281 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 962bfebc-1eb0-441e-b7a7-854418b7ce4f
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 4c5c426a-0416-486b-9ee6-7b42214d0e0f
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:27:18.423 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 962bfebc-1eb0-441e-b7a7-854418b7ce4f
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:27:18.546 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:27:18.546 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:27:18.547 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:27:18.547 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:27:19.876 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:26:28 PM"}
2021-08-11 16:27:19.880 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:116) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:27:19.912 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 962bfebc-1eb0-441e-b7a7-854418b7ce4f
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"962bfebc-1eb0-441e-b7a7-854418b7ce4f"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:27:30.099 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 7cd9a673-fbaa-4496-bdc3-62f5676b62b5
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : bb72da17-7635-4160-90c2-ab2b5e5321e5
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:27:30.105 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 7cd9a673-fbaa-4496-bdc3-62f5676b62b5
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200920112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:27:30.106 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:27:30.106 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:27:30.107 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:27:30.107 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:27:30.139 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200930112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:26:28 PM"}
2021-08-11 16:27:30.140 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:27:30.140 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:27:30.141 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:27:30.141 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:27:30.141 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:27:30.142 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:27:30.601 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:27:30.603 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200920112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:27:40.803 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:27:40.803 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:27:40.804 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:27:40.805 handleAllOtherException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Exception: null
java.lang.NullPointerException: null
	at vn.vnpay.preprocess.util.ResponsePreProcessor.buildResponseEntity(ResponsePreProcessor.java:15) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:33) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:27:40.808 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 7cd9a673-fbaa-4496-bdc3-62f5676b62b5
[BODY RESPONSE]: 

{"code":"500","responseId":"7cd9a673-fbaa-4496-bdc3-62f5676b62b5"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:32:34.716 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 6300 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:32:34.739 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:32:34.739 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:32:39.342 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 5.53 seconds (JVM running for 8.47)
2021-08-11 16:33:00.894 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 4c68511a-f844-4dda-8852-2b0519a53573
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : ccc3bd5c-61ee-4321-9b08-d82e2d2e4871
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:33:01.048 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 4c68511a-f844-4dda-8852-2b0519a53573
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200921112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:33:01.141 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:33:01.141 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:33:01.143 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:33:01.144 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:33:02.320 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200920112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:32:49 PM"}
2021-08-11 16:33:02.321 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:33:02.321 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:33:02.321 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:33:02.322 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:33:02.322 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:33:02.322 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:33:02.808 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:33:02.811 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200921112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:33:13.064 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:33:13.064 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:33:13.065 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:33:13.066 handleAllOtherException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Exception: null
java.lang.NullPointerException: null
	at vn.vnpay.preprocess.util.ResponsePreProcessor.buildResponseEntity(ResponsePreProcessor.java:15) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:33) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:33:13.088 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 4c68511a-f844-4dda-8852-2b0519a53573
[BODY RESPONSE]: 

{"code":"500","responseId":"4c68511a-f844-4dda-8852-2b0519a53573"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:34:07.868 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 10116 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:34:07.883 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:34:07.884 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:34:12.375 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 5.297 seconds (JVM running for 8.06)
2021-08-11 16:34:47.232 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: e8b50f13-b73d-4a1e-a1f6-b0813ae20d0c
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : a136a8ba-87ae-463a-ab1e-313cfbec1fbe
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:34:47.368 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: e8b50f13-b73d-4a1e-a1f6-b0813ae20d0c
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200921112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:34:47.509 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:34:47.509 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:34:47.509 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:34:47.510 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:34:48.862 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200921112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:33:03 PM"}
2021-08-11 16:34:48.868 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:116) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:34:48.898 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: e8b50f13-b73d-4a1e-a1f6-b0813ae20d0c
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"e8b50f13-b73d-4a1e-a1f6-b0813ae20d0c"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:34:55.753 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: f3db3385-6563-43ef-b724-6067da367525
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : b2d66aca-8a0b-4d0c-91aa-74dd90ae3a68
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:34:55.758 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: f3db3385-6563-43ef-b724-6067da367525
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200922112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:34:55.759 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:34:55.759 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:34:55.759 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:34:55.759 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:34:55.769 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200921112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:33:03 PM"}
2021-08-11 16:34:55.770 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:34:55.770 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:34:55.770 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:34:55.771 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:34:55.772 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:34:55.773 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:34:56.258 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:34:56.259 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200922112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:35:01.460 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:35:01.461 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 16:35:01.462 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 16:35:01.463 handleAllOtherException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Exception: null
java.lang.NullPointerException: null
	at vn.vnpay.preprocess.util.ResponsePreProcessor.buildResponseEntity(ResponsePreProcessor.java:15) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:33) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:35:01.478 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: f3db3385-6563-43ef-b724-6067da367525
[BODY RESPONSE]: 

{"code":"500","responseId":"f3db3385-6563-43ef-b724-6067da367525"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:40:56.230 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 6868 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:40:56.246 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:40:56.246 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:41:01.594 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 6.234 seconds (JVM running for 9.193)
2021-08-11 16:41:49.082 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: c9b3e5af-e633-47c6-8be8-173a39a9a036
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 3072a282-1f00-4c27-95cc-082825cd4198
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:41:49.238 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: c9b3e5af-e633-47c6-8be8-173a39a9a036
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200922112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:41:49.348 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:41:49.349 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:41:49.349 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:41:49.349 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:41:50.732 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200922112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:34:57 PM"}
2021-08-11 16:41:50.740 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:41:50.781 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: c9b3e5af-e633-47c6-8be8-173a39a9a036
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"c9b3e5af-e633-47c6-8be8-173a39a9a036"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:41:56.160 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 7409eea3-34c4-4d56-8cb8-2ad8cf0ca8fe
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 29010291-fb46-443d-8695-43648aa6d469
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:41:56.163 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 7409eea3-34c4-4d56-8cb8-2ad8cf0ca8fe
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200923112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:41:56.164 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:41:56.164 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:41:56.164 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:41:56.164 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:41:56.174 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200922112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:34:57 PM"}
2021-08-11 16:41:56.175 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:41:56.176 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:41:56.176 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:41:56.176 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:41:56.176 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:41:56.177 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:41:56.744 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:41:56.745 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200923112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:42:06.956 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:42:06.958 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.sendRabbitMQ(PaymentServiceImpl.java:110) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:120) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:42:06.963 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 7409eea3-34c4-4d56-8cb8-2ad8cf0ca8fe
[BODY RESPONSE]: 

{"code":"400","message":"request timeout to execute in queue","responseId":"7409eea3-34c4-4d56-8cb8-2ad8cf0ca8fe"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:44:15.149 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 1292 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:44:15.196 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:44:15.196 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:44:20.215 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 5.989 seconds (JVM running for 9.082)
2021-08-11 16:44:56.645 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 3b91e562-225f-4a7c-8de8-875c9ea8d695
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 7c861db7-f043-4d05-b0d7-810f50bb2351
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:44:56.782 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 3b91e562-225f-4a7c-8de8-875c9ea8d695
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200923112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:44:56.907 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:44:56.907 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:44:56.908 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:44:56.910 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:45:00.634 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200923112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:41:57 PM"}
2021-08-11 16:45:00.647 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:45:00.735 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 3b91e562-225f-4a7c-8de8-875c9ea8d695
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"3b91e562-225f-4a7c-8de8-875c9ea8d695"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:45:08.024 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 8554fcd3-15f6-4792-a68a-16ca0c8edb24
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : ba1a71d6-5b01-44c8-b4e2-f2c059ab7624
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:45:08.030 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 8554fcd3-15f6-4792-a68a-16ca0c8edb24
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:45:08.030 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:45:08.031 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:45:08.031 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:45:08.031 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:45:08.039 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200923112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:41:57 PM"}
2021-08-11 16:45:08.041 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:45:08.041 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:45:08.041 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:45:08.042 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:45:08.043 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:45:08.043 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:45:08.580 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:45:08.580 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:45:18.798 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:45:18.799 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: null
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.sendRabbitMQ(PaymentServiceImpl.java:110) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:120) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:45:18.801 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 8554fcd3-15f6-4792-a68a-16ca0c8edb24
[BODY RESPONSE]: 

{"code":"400","message":"request timeout to execute in queue","responseId":"8554fcd3-15f6-4792-a68a-16ca0c8edb24"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:47:53.356 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 15748 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:47:53.369 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:47:53.370 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:47:55.923 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 3.238 seconds (JVM running for 6.394)
2021-08-11 16:48:15.892 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 714e0965-1df8-4eed-aac1-d01301caf347
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : b2467b43-9b1c-4dc0-b82b-1df75d000e75
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:48:16.029 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 714e0965-1df8-4eed-aac1-d01301caf347
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:48:16.116 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:48:16.116 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:48:16.116 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:48:16.117 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:48:17.652 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:45:09 PM"}
2021-08-11 16:48:17.714 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 714e0965-1df8-4eed-aac1-d01301caf347
[BODY RESPONSE]: 

{"timestamp":"Aug 11, 2021 4:48:17 PM","status":500,"error":"Internal Server Error","trace":"vn.vnpay.preprocess.exception.CustomException: same day token key\r\n\tat vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47)\r\n\tat vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94)\r\n\tat vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118)\r\n\tat vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.lang.reflect.Method.invoke(Method.java:498)\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197)\r\n\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141)\r\n\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106)\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)\r\n\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808)\r\n\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)\r\n\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064)\r\n\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963)\r\n\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006)\r\n\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909)\r\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:681)\r\n\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883)\r\n\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:764)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)\r\n\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190)\r\n\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163)\r\n\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202)\r\n\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97)\r\n\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542)\r\n\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143)\r\n\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)\r\n\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78)\r\n\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357)\r\n\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382)\r\n\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65)\r\n\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893)\r\n\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723)\r\n\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\r\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)\r\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)\r\n\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\r\n\tat java.lang.Thread.run(Thread.java:748)\r\n","message":"same day token key","path":"/payment/"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:50:10.191 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 9692 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:50:10.203 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:50:10.204 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:50:12.936 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 3.311 seconds (JVM running for 6.323)
2021-08-11 16:50:45.603 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 7614e178-e879-4db3-88c2-a45849110a06
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : e62b7be0-c6c3-4a8f-8306-50872af9c23e
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:50:45.720 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 7614e178-e879-4db3-88c2-a45849110a06
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:50:45.821 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:50:45.821 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:50:45.821 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:50:45.822 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:50:47.381 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:45:09 PM"}
2021-08-11 16:50:47.394 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: same day token key
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:50:47.439 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 7614e178-e879-4db3-88c2-a45849110a06
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"7614e178-e879-4db3-88c2-a45849110a06"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:51:41.106 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: ceff2120-8b00-4f55-9ab7-fc9d832f3163
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : d5735ba3-6150-4806-a456-518fe93ab5fc
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:51:41.112 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: ceff2120-8b00-4f55-9ab7-fc9d832f3163
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:51:41.113 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:51:41.114 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:51:41.114 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:51:41.115 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:51:41.123 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200924112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 4:45:09 PM"}
2021-08-11 16:51:41.124 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 16:51:41.124 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 16:51:41.125 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 16:51:41.125 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 16:51:41.126 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 16:51:41.127 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 16:51:41.636 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 16:51:41.637 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 16:51:51.845 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: null
2021-08-11 16:51:51.847 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: request timeout to execute in queue
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.sendRabbitMQ(PaymentServiceImpl.java:110) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:120) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:51:51.854 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: ceff2120-8b00-4f55-9ab7-fc9d832f3163
[BODY RESPONSE]: 

{"code":"400","message":"request timeout to execute in queue","responseId":"ceff2120-8b00-4f55-9ab7-fc9d832f3163"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:53:42.725 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 18904 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:53:42.739 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:53:42.739 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:53:47.319 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 5.669 seconds (JVM running for 10.559)
2021-08-11 16:54:59.629 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: fae0d566-9154-4b2b-a2dc-e0a44d2e7835
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 2e58921d-eabd-4264-b3cc-d758e3e5562d
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:54:59.790 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: fae0d566-9154-4b2b-a2dc-e0a44d2e7835
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:54:59.938 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:54:59.938 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:54:59.938 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:54:59.938 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:55:01.536 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:51:41 PM"}
2021-08-11 16:55:01.541 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: {}
vn.vnpay.preprocess.exception.CustomException: same day token key
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:55:01.588 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: fae0d566-9154-4b2b-a2dc-e0a44d2e7835
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"fae0d566-9154-4b2b-a2dc-e0a44d2e7835"}

LOGGING RESPONSE-----------------------------------

2021-08-11 16:55:48.523 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Starting PreprocessTransactionApplication using Java 1.8.0_261 on DESKTOP-CPQCDS8 with PID 244 (C:\Users\dell\my-workspace\demo-payment\preprocess-transaction\target\classes started by dell in C:\Users\dell\my-workspace\demo-payment)
2021-08-11 16:55:48.537 logStarting --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Running with Spring Boot v2.5.3, Spring v5.3.9
2021-08-11 16:55:48.538 logStartupProfileInfo --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : No active profile set, falling back to default profiles: default
2021-08-11 16:55:51.431 logStarted --- TokenKey [] vn.vnpay.preprocess.PreprocessTransactionApplication : Started PreprocessTransactionApplication in 3.528 seconds (JVM running for 6.633)
2021-08-11 16:56:37.900 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: fd3e99b4-fac2-4ef9-8c8a-3cbc6ed660ac
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : b0053578-6daf-4b8c-adf8-b596cfe20040
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 16:56:38.206 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: fd3e99b4-fac2-4ef9-8c8a-3cbc6ed660ac
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 16:56:38.533 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 16:56:38.533 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 16:56:38.535 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 16:56:38.535 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 16:56:40.307 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:51:41 PM"}
2021-08-11 16:56:40.311 handleCustomException --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.handler.CustomRestExceptionHandler : Handler for CustomException: 
vn.vnpay.preprocess.exception.CustomException: same day token key
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkDuplicateToken(PaymentServiceImpl.java:47) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.checkValidPayment(PaymentServiceImpl.java:94) ~[classes/:?]
	at vn.vnpay.preprocess.service.impl.PaymentServiceImpl.executePayment(PaymentServiceImpl.java:118) ~[classes/:?]
	at vn.vnpay.preprocess.controller.PaymentController.executePayment(PaymentController.java:32) ~[classes/:?]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_261]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_261]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_261]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_261]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:197) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:141) ~[spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:106) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:808) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1064) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:963) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.3.9.jar:5.3.9]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:681) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.3.9.jar:5.3.9]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:764) [tomcat-embed-core-9.0.50.jar:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:228) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at vn.vnpay.preprocess.filter.CustomURLFilter.doFilter(CustomURLFilter.java:31) [classes/:?]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.3.9.jar:5.3.9]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.3.9.jar:5.3.9]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:190) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:163) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:357) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:382) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:893) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1723) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [?:1.8.0_261]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [?:1.8.0_261]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.50.jar:9.0.50]
	at java.lang.Thread.run(Thread.java:748) [?:1.8.0_261]
2021-08-11 16:56:40.340 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: fd3e99b4-fac2-4ef9-8c8a-3cbc6ed660ac
[BODY RESPONSE]: 

{"code":"400","message":"same day token key","responseId":"fd3e99b4-fac2-4ef9-8c8a-3cbc6ed660ac"}

LOGGING RESPONSE-----------------------------------

2021-08-11 17:10:25.156 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 725d68f8-3a25-472e-8208-61fd8a5b7d26
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 038241f1-fb96-49fd-94fc-41b364c10423
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 17:10:25.165 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 725d68f8-3a25-472e-8208-61fd8a5b7d26
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200927112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 17:10:25.166 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 17:10:25.166 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 17:10:25.166 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 17:10:25.166 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 17:10:25.173 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200925112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 4:51:41 PM"}
2021-08-11 17:10:25.175 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 17:10:25.175 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 17:10:25.178 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 17:10:25.178 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 17:10:25.179 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 17:10:25.179 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 17:10:25.886 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 17:10:25.887 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200927112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 17:10:36.266 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: {"code":"200","message":"Success","data":{"id":1,"createdAt":1628676627239,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200927112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}
2021-08-11 17:10:36.267 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 17:10:36.267 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 17:10:36.269 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 725d68f8-3a25-472e-8208-61fd8a5b7d26
[BODY RESPONSE]: 

{"code":"200","message":"Success","responseId":"725d68f8-3a25-472e-8208-61fd8a5b7d26","data":{"id":1,"createdAt":1628676627239,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200927112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}

LOGGING RESPONSE-----------------------------------

2021-08-11 17:10:46.037 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: e6d61552-d221-40e8-8d65-ee2cb140f4d1
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 8144a3dc-faae-4156-9795-e6b79b70207d
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 17:10:46.038 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: e6d61552-d221-40e8-8d65-ee2cb140f4d1
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 17:10:46.039 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 17:10:46.039 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 17:10:46.040 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 17:10:46.040 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 17:10:46.051 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200927112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":1,"createdAt":"Aug 11, 2021 5:10:27 PM"}
2021-08-11 17:10:46.052 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 17:10:46.052 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 17:10:46.052 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 17:10:46.052 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 17:10:46.052 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 17:10:46.053 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 17:10:46.100 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 17:10:46.101 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 17:10:46.321 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: {"code":"200","message":"Success","data":{"id":2,"createdAt":1628676646232,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}
2021-08-11 17:10:46.322 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 17:10:46.323 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 17:10:46.326 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: e6d61552-d221-40e8-8d65-ee2cb140f4d1
[BODY RESPONSE]: 

{"code":"200","message":"Success","responseId":"e6d61552-d221-40e8-8d65-ee2cb140f4d1","data":{"id":2,"createdAt":1628676646232,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}

LOGGING RESPONSE-----------------------------------

2021-08-11 17:11:02.037 logRequest --- TokenKey [] vn.vnpay.preprocess.filter.CustomURLFilter : 
LOGGING REQUEST-----------------------------------
[REQUEST-ID]: 8478cfcd-2b6a-46d4-b83b-2c11040bd681
[PATH]: /payment/
[QUERIES]: null
[HEADERS]: 
---content-type : application/json
---user-agent : PostmanRuntime/7.28.3
---accept : */*
---postman-token : 7e4bf874-01e1-4c9a-aa3c-1a32ea9a1652
---host : localhost:8082
---accept-encoding : gzip, deflate, br
---connection : keep-alive
---content-length : 562
LOGGING REQUEST-----------------------------------

2021-08-11 17:11:02.042 logRequest --- TokenKey [] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING REQUEST BODY-----------------------------------
[REQUEST-ID]: 8478cfcd-2b6a-46d4-b83b-2c11040bd681
[BODY REQUEST]: 

{"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}

LOGGING REQUEST BODY-----------------------------------

2021-08-11 17:11:02.044 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin executePayment =====
2021-08-11 17:11:02.045 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkValidPayment =====
2021-08-11 17:11:02.045 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkDuplicateToken =====
2021-08-11 17:11:02.046 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : get Payment By tokenKey from Redis
2021-08-11 17:11:02.052 getByTokenKey --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentRedisServiceImpl : Payment By tokenKey from Redis: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200928112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}","id":2,"createdAt":"Aug 11, 2021 5:10:46 PM"}
2021-08-11 17:11:02.053 checkDuplicateToken --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkDuplicateToken =====
2021-08-11 17:11:02.053 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkRealAmount =====
2021-08-11 17:11:02.053 checkRealAmount --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkRealAmount =====
2021-08-11 17:11:02.054 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin checkPromotionCode =====
2021-08-11 17:11:02.054 checkPromotionCode --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkPromotionCode =====
2021-08-11 17:11:02.054 checkValidPayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end checkValidPayment =====
2021-08-11 17:11:02.098 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== begin sendRabbitMQ =====
2021-08-11 17:11:02.099 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : send payment: {"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}
2021-08-11 17:11:02.248 send  --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.RabbitMQServiceImpl : response: {"code":"200","message":"Success","data":{"id":3,"createdAt":1628676662171,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}
2021-08-11 17:11:02.249 sendRabbitMQ --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end sendRabbitMQ =====
2021-08-11 17:11:02.249 executePayment --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.service.impl.PaymentServiceImpl : ===== end executePayment =====
2021-08-11 17:11:02.250 logResponse --- TokenKey [1601353776839FT19310RH6P1] vn.vnpay.preprocess.util.LoggingComponent : 
LOGGING RESPONSE-----------------------------------
[REQUEST-ID]: 8478cfcd-2b6a-46d4-b83b-2c11040bd681
[BODY RESPONSE]: 

{"code":"200","message":"Success","responseId":"8478cfcd-2b6a-46d4-b83b-2c11040bd681","data":{"id":3,"createdAt":1628676662171,"tokenKey":"1601353776839FT19310RH6P1","apiID":"restPayment","mobile":"0345225630","bankCode":"970445","accountNo":"0001100014211002","payDate":"20200929112923","additionalData":"","debitAmount":11200,"respCode":"00","respDesc":"SUCCESS","traceTransfer":"FT19310RH6P1","messageType":"1","checkSum":"40e670720b754324af3d3a0ff49b52fb","orderCode":"FT19310RH6P1","userName":"cntest001","realAmount":"11100","promotionCode":"   123 ","addValue":"{\"payMethod\":\"01\",\"payMethodMMS\":1}"}}

LOGGING RESPONSE-----------------------------------

